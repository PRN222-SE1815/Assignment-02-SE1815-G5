@using System.Security.Claims
@{
    var userRole = User.FindFirst(ClaimTypes.Role)?.Value ?? "";
    var userName = User.Identity?.Name ?? "Guest";
    var isAdmin = userRole == "ADMIN";
    var isTeacher = userRole == "TEACHER";
    var isStudent = userRole == "STUDENT";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-brand">
            @if (isAdmin)
            {
                <a asp-area="Admin" asp-page="/Index" class="brand-link">
                    <span class="brand-icon"><i class="fas fa-graduation-cap"></i></span>
                    <span class="brand-text">TPF University</span>
                </a>
            }
            else if (isTeacher)
            {
                <a asp-area="Teacher" asp-page="/Index" class="brand-link">
                    <span class="brand-icon"><i class="fas fa-graduation-cap"></i></span>
                    <span class="brand-text">TPF University</span>
                </a>
            }
            else if (isStudent)
            {
                <a asp-area="Student" asp-page="/Index" class="brand-link">
                    <span class="brand-icon"><i class="fas fa-graduation-cap"></i></span>
                    <span class="brand-text">TPF University</span>
                </a>
            }
            else
            {
                <a asp-page="/Account/Login" class="brand-link">
                    <span class="brand-icon"><i class="fas fa-graduation-cap"></i></span>
                    <span class="brand-text">TPF University</span>
                </a>
            }
        </div>

        <div class="navbar-menu">
            @if (isAdmin)
            {
                <a asp-area="Admin" asp-page="/UserManagement/Create" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-users-cog"></i></span>
                    <span class="nav-text">User Management</span>
                </a>
                <a asp-area="Admin" asp-page="/ScheduleManagement/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-calendar-alt"></i></span>
                    <span class="nav-text">Schedule</span>
                </a>
                <a href="#" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-book"></i></span>
                    <span class="nav-text">Courses</span>
                </a>
                <a href="#" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-chart-bar"></i></span>
                    <span class="nav-text">Reports</span>
                </a>
            }
            else if (isTeacher)
            {
                <a asp-area="Teacher" asp-page="/TeacherGrade/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-chalkboard-teacher"></i></span>
                    <span class="nav-text">My Classes</span>
                </a>
                <a asp-area="Teacher" asp-page="/TeacherGrade/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-pen-to-square"></i></span>
                    <span class="nav-text">Grading</span>
                </a>
                <a asp-page="/Chat/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-comments"></i></span>
                    <span class="nav-text">Chat</span>
                </a>
            }
            else if (isStudent)
            {
                <a asp-area="Student" asp-page="/MyCourses/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-book-open"></i></span>
                    <span class="nav-text">My Courses</span>
                </a>
                <a asp-area="Student" asp-page="/CourseRegistration/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-plus-circle"></i></span>
                    <span class="nav-text">Registration</span>
                </a>
                <a asp-area="Student" asp-page="/StudentSchedule/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-calendar-alt"></i></span>
                    <span class="nav-text">Schedule</span>
                </a>
                <a asp-area="Student" asp-page="/StudentGrade/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-graduation-cap"></i></span>
                    <span class="nav-text">Grades</span>
                </a>
                <a asp-page="/Chat/Index" class="nav-link">
                    <span class="nav-icon"><i class="fas fa-comments"></i></span>
                    <span class="nav-text">Chat</span>
                </a>
            }
        </div>

        <div class="navbar-user">
            @await Component.InvokeAsync("WalletBadge")

            <!-- Notification Bell -->
            <div class="notification-bell" id="notificationBell">
                <button type="button" class="bell-btn" onclick="toggleNotificationPanel()">
                    <span class="bell-icon"><i class="fas fa-bell"></i></span>
                    <span class="notification-count" id="notificationCount" style="display: none;">0</span>
                </button>
                <div class="notification-panel" id="notificationPanel">
                    <div class="panel-header">
                        <span><i class="fas fa-bell"></i> Notifications</span>
                        <button type="button" class="clear-btn" onclick="clearAllNotifications()">
                            <i class="fas fa-trash-alt"></i> Clear all
                        </button>
                    </div>
                    <div class="panel-body" id="notificationList">
                        <div class="empty-notifications">
                            <i class="fas fa-bell-slash"></i>
                            <p>No new notifications</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="user-info">
                <span class="user-role">
                    @if (isAdmin)
                    {
                        <i class="fas fa-user-shield"></i>
                    }
                    else if (isTeacher)
                    {
                        <i class="fas fa-chalkboard-teacher"></i>
                    }
                    else if (isStudent)
                    {
                        <i class="fas fa-user-graduate"></i>
                    }
                    @userRole
                </span>
                <span class="user-name">@userName</span>
            </div>
            @if (User.Identity?.IsAuthenticated == true)
            {
                <form asp-page="/Account/Login" asp-page-handler="Logout" method="post" class="logout-form">
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn-logout">
                        <span class="logout-icon"><i class="fas fa-sign-out-alt"></i></span>
                        <span class="logout-text">Logout</span>
                    </button>
                </form>
            }
        </div>
    </div>
</nav>
